{"version":3,"file":"TheSearch-6c2f2ca9.js","sources":["../../../../types/search-schema-yup.ts","../../../../stores/search.ts","../../../../stores/sucursal.ts","../../../../components/TheSearch.vue"],"sourcesContent":["import * as Yup from 'yup'; \n\nexport const schema = Yup.object({\n    sucursal: Yup.object().required(),\n    fechaRetiro: Yup.date().required(), \n    sucursalRetorno: Yup.object().required(),\n    fechaRetorno: Yup.date().required(), \n});  ","import { defineStore } from 'pinia'\r\nimport moment from 'moment'; \r\nimport { useForm } from 'vee-validate'; \r\nimport { usePedidoStore } from '@/stores/pedido';  \r\nimport { schema } from '@/types/search-schema-yup';\r\n\r\nexport const useSearchStore = defineStore('search',  () => { \r\n    let searchIs = ref('default')\r\n    const storePedido = usePedidoStore();\r\n    const router = useRouter(); \r\n\r\n    const mostrarWarning = ref(false)\r\n\r\n    const { errors, useFieldModel, handleSubmit, values } = useForm({\r\n        validationSchema: schema,\r\n    }); \r\n\r\n    const [\r\n        sucursal, \r\n        fechaRetiro,\r\n        fechaRetorno,\r\n        sucursalRetorno,\r\n        ] = useFieldModel([\r\n        'sucursal', \r\n        'fechaRetiro',\r\n        'fechaRetorno',\r\n        'sucursalRetorno',  \r\n        ]);\r\n        \r\n        \r\n    const siguiente = handleSubmit((values) => {\r\n        // send values to API\r\n        // console.log('Submit', JSON.stringify(values, null, 2));\r\n        // console.log(\"en Search Store\", values);\r\n        storePedido.pedido.sucursal = values.sucursal; \r\n        storePedido.pedido.diaRetiro = values.fechaRetiro; \r\n        storePedido.pedido.sucursalRetorno = values.sucursalRetorno; \r\n        storePedido.pedido.diaRetorno = values.fechaRetorno;   \r\n        \r\n        searchIs = ref('TheProgress');  \r\n        router.push('/reserva/');  \r\n    });   \r\n    return {\r\n        errors,\r\n        sucursal,\r\n        fechaRetiro,\r\n        fechaRetorno,\r\n        sucursalRetorno, \r\n        siguiente,\r\n        mostrarWarning,\r\n        searchIs\r\n    };\r\n});  ","import { defineStore } from 'pinia' \n \nexport const useSucursalStore = defineStore('sucursal', {\n    // a function that returns a fresh state - STATE ES COMO DATA\nstate: () => ({ \n    sucursales: [\n            {\n                sucursal: { \n                id: Number,\n                mapa: Object,\n                imagen: String,\n                name: String,\n                telefono_1: String,\n                telefono_2: null,\n                horario_cierre: Number,\n                LocationCode: String,\n                horario_apertura: Number,\n                horario_cierre_sabado: Number,\n                horario_cierre_domingo: Number,\n                horario_apertura_sabado: Number,\n                horario_apertura_domingo: Number,\n                festivo: Number,\n                dias_festivos: String\n            }\n        }\n    ]\n}),\n// optional getters GETTER SON COMO COMPUTED \ngetters: {\n    getSucursales: (state) => { \n        return state.sucursales \n    },  \n    // GETTER SON COMO COMPUTED getters receive the state as first parameter \n},\n// optional   ACTIONS SON COMO METHODS\nactions: {\n        async fetchSucursales(){\n                try {\n                    const { getItems } = useDirectusItems(); \n                    const sucursales = await getItems(\n                        { collection: \"sucursal_hertz\", params : { fields: [\"*\",\"picture.*\"] }});\n                        this.sucursales = sucursales\n                } catch (error) {\n                        console.error(error); \n                }\n            },  \n        // sucursalABuscador(selected){\n        //     storeSearch.sucursal = selected\n        // },  \n    },\n})  ","<script setup>\nimport { useSearchStore } from \"@/stores/search\";\nimport { storeToRefs } from \"pinia\";\nimport { useSucursalStore } from \"@/stores/sucursal\";\nimport { defineRule, Form, Field, ErrorMessage, configure } from \"vee-validate\";\nimport { ref, computed } from \"vue\";\nconst date = ref(new Date());\n\nconst storeSearch = useSearchStore();\n\nconst storeSucursal = useSucursalStore();\n\nconst sucursales = computed(() => {\n  return storeSucursal.sucursales;\n});\nonMounted(() => {\n  storeSucursal.fetchSucursales();\n  // storeSearch.options = sucursales;\n});\n\nfunction minimoDeDias(date, days) {\n  const newDate = new Date(date);\n  newDate.setDate(newDate.getDate() + days);\n  return newDate;\n}\n\nfunction minimoDeHoras(date, horas) {\n  const newDate = new Date(date);\n  newDate.setDate(newDate.getDate() + horas);\n  return newDate;\n}\n\nconst startTime = ref({ hours: 10, minutes: 15 });\n\nfunction getWorkingHours(openingTime, closingTime) {\n  let workingHours = [];\n  // con fecha queremos revisar si la fecha de retiro es hoy y sumarle horas\n  for (let i = openingTime; i < closingTime; i++) {\n    workingHours.push({ text: `${i}`, value: i });\n  }\n  return workingHours;\n}\n\nfunction domingoCerrados(domingoApertura, domingoCierre) {\n  if (domingoApertura === 0 && domingoCierre === 0) {\n    return [0];\n  }\n}\n\nfunction horarioFines(openingTime, closingTime) {\n  let fines = [];\n  for (let i = openingTime; i < closingTime; i++) {\n    fines.push({ text: `${i}`, value: i });\n  }\n  return fines;\n}\n\nconst minutesArray = [\n  { text: \"00\", value: 0 },\n  { text: \"15\", value: 15 },\n  { text: \"30\", value: 30 },\n  { text: \"45\", value: 45 },\n];\n</script>\n<template>\n  <form class=\"reservador\" @submit=\"storeSearch.siguiente\">\n    <article>\n      <h2>Reserva tu veh√≠culo</h2>\n      <div class=\"sucursales\">\n        <section>\n          <legend>sucursal de retiro</legend>\n          <label class=\"sucursal\">\n            <select\n              v-model=\"storeSearch.sucursal\"\n              name=\"sucursal\"\n              as=\"select\"\n              rules=\"required\"\n            >\n              <option disabled value=\"\">Selecciona una sucursal</option>\n              <option v-for=\"option in sucursales\" :key=\"option\" :value=\"option\">\n                {{ option.name }}\n              </option>\n            </select>\n          </label>\n        </section>\n        <section>\n          <legend>sucursal de retorno</legend>\n          <label class=\"sucursal\">\n            <select\n              v-model=\"storeSearch.sucursalRetorno\"\n              name=\"sucursalRetorno\"\n              as=\"select\"\n              rules=\"required\"\n            >\n              <option disabled value=\"\">Selecciona una sucursal</option>\n              <option v-for=\"option in sucursales\" :key=\"option\" :value=\"option\">\n                {{ option.name }}\n              </option>\n            </select>\n          </label>\n        </section>\n      </div>\n      <section class=\"fechas\">\n        <div v-if=\"storeSearch.sucursal\">\n          <label>Fecha de Retiro </label>\n          <date-picker\n            :start-time=\"startTime\"\n            locale=\"es\"\n            v-model=\"storeSearch.fechaRetiro\"\n            :minDate=\"new Date()\"\n            :disabled-week-days=\"\n              domingoCerrados(\n                storeSearch.sucursal.horario_apertura_domingo,\n                storeSearch.sucursal.horario_cierre_domingo\n              )\n            \"\n            :highlight=\"storeSearch.sucursal.dias_festivos\"\n            :disabled-dates=\"storeSearch.sucursal.dias_festivos\"\n            highlight-disabled-days\n          >\n            <template #time-picker=\"{ time, updateTime }\">\n              <div class=\"custom-time-picker-component\">\n                <select\n                  class=\"select-input\"\n                  :value=\"time.hours\"\n                  @change=\"updateTime(+$event.target.value)\"\n                >\n                  <option\n                    v-for=\"h in getWorkingHours(\n                      storeSearch.sucursal.horario_apertura,\n                      storeSearch.sucursal.horario_cierre\n                    )\"\n                    :key=\"h.value\"\n                    :value=\"h.value\"\n                  >\n                    {{ h.text }}\n                  </option>\n                </select>\n\n                <select\n                  class=\"select-input\"\n                  :value=\"time.minutes\"\n                  @change=\"updateTime(+$event.target.value, false)\"\n                >\n                  <option v-for=\"m in minutesArray\" :key=\"m.value\" :value=\"m.value\">\n                    {{ m.text }}\n                  </option>\n                </select>\n              </div>\n            </template>\n          </date-picker>\n        </div>\n\n        <div v-if=\"storeSearch.sucursalRetorno\">\n          <label>Fecha de Retorno</label>\n          <date-picker\n            locale=\"es\"\n            :start-time=\"startTime\"\n            v-model=\"storeSearch.fechaRetorno\"\n            :minDate=\"\n              minimoDeDias(\n                storeSearch.fechaRetiro,\n                storeSearch.sucursalRetorno.minimo_dias\n              )\n            \"\n            :disabled-week-days=\"\n              domingoCerrados(\n                storeSearch.sucursalRetorno.horario_apertura_domingo,\n                storeSearch.sucursalRetorno.horario_cierre_domingo\n              )\n            \"\n            :highlight=\"storeSearch.sucursalRetorno.dias_festivos\"\n            :disabled-dates=\"storeSearch.sucursalRetorno.dias_festivos\"\n            highlight-disabled-days\n          >\n            <template #time-picker=\"{ time, updateTime }\">\n              <div class=\"custom-time-picker-component\">\n                <select\n                  class=\"select-input\"\n                  :value=\"time.hours\"\n                  @change=\"updateTime(+$event.target.value)\"\n                >\n                  <option\n                    v-for=\"h in getWorkingHours(\n                      storeSearch.sucursalRetorno.horario_apertura,\n                      storeSearch.sucursalRetorno.horario_cierre\n                    )\"\n                    :key=\"h.value\"\n                    :value=\"h.value\"\n                  >\n                    {{ h.text }}\n                  </option>\n                </select>\n\n                <select\n                  class=\"select-input\"\n                  :value=\"time.minutes\"\n                  @change=\"updateTime(+$event.target.value, false)\"\n                >\n                  <option v-for=\"m in minutesArray\" :key=\"m.value\" :value=\"m.value\">\n                    {{ m.text }}\n                  </option>\n                </select>\n              </div>\n            </template>\n          </date-picker>\n        </div>\n      </section>\n      <div class=\"verificar-wrap\">\n        <button\n          class=\"verificar\"\n          type=\"submit\"\n          @click=\"storeSearch.searchIs = 'TheProgress'\"\n        >\n          Siguiente\n        </button>\n      </div>\n \n      <!-- <ErrorMessage name=\"sucursal\" >\n                <p class=\"warn\">Todos los Campos son requeridos</p> \n            </ErrorMessage>   -->\n    </article>\n \n  </form>\n</template>\n<style lang=\"scss\">\n.dp__theme_light {\n  --dp-background-color: #ffffff;\n  --dp-text-color: #212121;\n  --dp-hover-color: #f3f3f3;\n  --dp-hover-text-color: #212121;\n  --dp-hover-icon-color: #959595;\n  --dp-primary-color: #ffd115;\n  --dp-primary-text-color: #000000;\n  --dp-secondary-color: #c0c4cc;\n  --dp-border-color: #ddd;\n  --dp-menu-border-color: #ddd;\n  --dp-border-color-hover: #aaaeb7;\n  --dp-disabled-color: #f6f6f6;\n  --dp-scroll-bar-background: #f3f3f3;\n  --dp-scroll-bar-color: #959595;\n  --dp-success-color: #000000a1;\n  --dp-success-color-disabled: #a3d9b1;\n  --dp-icon-color: #000000a1;\n  --dp-danger-color: #ff6f60;\n  --dp-highlight-color: #be7d7d;\n}\n\n.custom-time-picker-component {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.select-input {\n  margin: 5px 3px;\n  padding: 5px;\n  width: 100px;\n  border-color: var(--dp-border-color);\n  outline: none;\n  -webkit-appearance: menulist;\n}\n\n.warn {\n  font-size: 12px;\n}\n.dpicker {\n  width: 100%;\n}\n.slot-icon {\n  height: 12px;\n  width: auto;\n  padding-left: 5px;\n}\n.reservador {\n  background: #282828;\n  padding: 5px;\n  box-sizing: border-box;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  text-transform: uppercase;\n  color: white;\n  align-items: center;\n  h2 {\n    font-size: 20px;\n    font-weight: bold;\n    padding: 0.2rem;\n  }\n  legend {\n    font-size: 14px;\n    font-weight: bold;\n  }\n\n  section {\n    padding: 0.5rem;\n    font-weight: bold;\n    font-size: 14px;\n  }\n  select {\n    width: 100%;\n    height: 40px;\n  }\n}\n.fechas {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n  .hora {\n    margin-left: 30px;\n    width: 150px;\n  }\n}\n.sucursales {\n  width: 100%;\n  h2 {\n    font-size: 16px;\n  }\n}\n\n.siguiente {\n  padding: 8px;\n}\n\n.verificar {\n  padding: 10px;\n  font-weight: bold;\n  font-size: 14px;\n  background: #FFD115;\n  color: rgb(0, 0, 0);\n  margin-top: 5px;\n  align-self: end;\n  cursor: pointer;\n  border-radius: 3px;\n}\n.verificar-wrap {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n// Desktop\n@media screen and (min-width: 768px) {\n  .siguiente {\n    align-self: flex-end;\n    margin-bottom: 10px;\n  }\n  .reservador {\n    justify-content: space-around;\n    .sucursales {\n      display: flex;\n      justify-content: space-around;\n    }\n    .fechas {\n      display: flex;\n      justify-content: space-between;\n      flex-direction: row; \n      .dpicker {\n        padding-right: 20px;\n      }\n      div {\n        display: flex;\n        flex-direction: column;\n      }\n      input {\n        width: 100%;\n      }\n    }\n    footer {\n      align-self: end;\n    }\n  }\n}\n</style>\n"],"names":[],"mappings":"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"}