{"version":3,"file":"_id_-6ce5c033.js","sources":["../../../../stores/tarjeta.ts","../../../../pages/orden/[id].vue"],"sourcesContent":["import { Pedido } from '~~/types/interfaces';\r\n \r\nexport const useTarjetaStore = defineStore\r\n('tarjeta', \r\n{ \r\n    state: () => ({\r\n        orden: [],\r\n        tarjeta: {\r\n            ccnumber: '',\r\n            ccexp: '',\r\n            cvv: ''\r\n        }\r\n    } ),  \r\n    actions: { \r\n        async onSubmit() {  \r\n            const orderId = this.orden.pedidos_id \r\n            // console.log(orderId)\r\n            const bodyData = { \r\n                'security_key': 'MDYevJ49jVF5cA8zzZ3ySYaC5A5G7AdH',\r\n                'first_name': this.orden.nombre,\r\n                'last_name': this.orden.apellido,\r\n                'address1': this.orden.retiro,\r\n                'city': 'Panama City',\r\n                'state': 'PTY',\r\n                'zip' : '12345', \r\n                'shipping_first_name': this.orden.nombre, \r\n                'shipping_last_name': this.orden.apellido,\r\n                'shipping_address1': '987 State St',\r\n                'shipping_city': 'Panama City',\r\n                'shipping_state': 'PTY',\r\n                'shipping_zip' : '98765', \r\n                'type': 'sale',\r\n                'amount': this.orden.total,\r\n                'ccnumber': this.tarjeta.ccnumber, \r\n                'ccexp': this.tarjeta.ccexp,\r\n                'cvv': this.tarjeta.cvv\r\n            }   \r\n            \r\n            await $fetch( '/api/tarjeta', { \r\n                method: 'POST',\r\n                // headers: {  \r\n                //     'Content-Type': 'application/x-www-form-urlencoded',\r\n                // },\r\n                params: bodyData,\r\n                body: bodyData ,   \r\n            }).then(function (response) {    \r\n                const router = useRouter(); \r\n                // console.log('THEN' + orderId)   \r\n                let respuesta = response; \r\n                let codigoAprobado = 'response=1';\r\n                let codigoTransaccionDeclinada = 'response=2';\r\n                let codigoErrorSistema = 'response=3'; \r\n\r\n                if (respuesta.includes(codigoAprobado)){  \r\n                    const { updateItem  } = useDirectusItems();  \r\n\r\n                    console.log('Transacción Aprobada' + orderId)    \r\n                    var status = { status: 'Pagado' }   \r\n                    updateItem<Pedido>({ \r\n                        collection: \"pedidos_hertz\",\r\n                        id: orderId,\r\n                        item: status });  \r\n                    \r\n                    router.push('/thanks/'); \r\n                }\r\n\r\n                else if (respuesta.includes(codigoTransaccionDeclinada)) { \r\n                    console.log('Transacción Declinada');   \r\n                    router.push('/error/'); \r\n                  } else if (respuesta.includes(codigoErrorSistema)) {\r\n                    console.log('Error en el sistema');   \r\n                    router.push('/error/'); \r\n                  }\r\n            })\r\n        }   \r\n    }\r\n}) ","<script setup>   \nimport { getAssetURL } from \"@/utils/get-asset-url\";\nimport { storeToRefs } from 'pinia'  \nimport { usePedidoStore } from '@/stores/pedido';   \nimport { useActualizarStore } from '@/stores/actualizar'\nimport { useTarjetaStore } from '@/stores/tarjeta' \nimport { usePaypalStore } from '@/stores/paypal';  \nimport moment from 'moment';  \n\nconst storePaypal = usePaypalStore(); \nconst storePedido = usePedidoStore();\nconst storeActualizar = useActualizarStore(); \nconst storeTarjeta = useTarjetaStore(); \nconst { getItemById, getItems } = useDirectusItems();  \n \n\n\nconst getPedido = computed(() => {\n    return storePedido.getPedido\n})\n \nconst route = useRoute()\n// const pedido = await getItemById({\n//         collection: \"pedidos\", \n//         id:  route.params.id, \n//         // id: route.params.id,\n//     });\nlet filters = { order_id: route.params.id };\nconst pedidos = await getItems({ \n    collection: \"pedidos_hertz\",\n    params: {\n        filter: filters\n    }\n}) \nconst pedido = pedidos[0]; \nonMounted(() => {  \n    storePedido.pedido = pedido; \n    storeActualizar.orden = pedido; \n    storeTarjeta.orden = pedido; \n})  \nconst fechaFormat = function(value) {\n    if (value) {\n        return moment(value).format('DD MMM YYYY hh:mm A')\n    }\n}\nconst precioFormat = function(value) {\n    if (value) {\n        return value.toLocaleString('en-US', { style: 'currency', currency: 'USD' }) \n    }\n} \n\n \n\nuseHead({\n        title: 'Modificando Reserva | Hertz Rent a Car Panamá'\n    });\n</script> \n<template>  \n    <article class=\"manage-pedido\"> \n        <h2>\n            Tu reserva:\n        </h2>\n            <section class=\"info-pedido\">\n                <header> \n                    <div> \n                        <h3>\n                            {{ pedido.carro.marca }} \n                            {{ pedido.carro.modelo }}  \n                        </h3>   \n                        <em>o similar</em> \n                    </div> \n                    <figure> \n                        <img :src=\"getAssetURL(pedido.carro.imagen)\"  loading=\"lazy\" /> \n                    </figure> \n                </header>\n\n                <section class=\"info-cliente\"> \n                    <h6>Detalles:</h6>  \n                        <dl>\n                            <dt>\n                                Nombre: \n                            </dt> \n                            <dd>\n                                {{ pedido.nombre }} {{ pedido.apellido }}\n                            </dd>\n                        </dl> \n                        <dl>\n                            <dt>\n                                Correo: \n                            </dt> \n                            <dd>\n                                {{ pedido.email }} \n                            </dd>\n                        </dl> \n                        <dl>\n                            <dt>\n                                Telefono: \n                            </dt> \n                            <dd>\n                                {{ pedido.telefono }}\n                            </dd>\n                        </dl> \n                        <dl>\n                            <dt>\n                                Licencia: \n                            </dt> \n                            <dd>\n                                {{ pedido.licencia }}\n                            </dd>\n                        </dl> \n                    \n                </section> \n\n                <section class=\"info-sucursal\">\n                    <h6>Sucursal:</h6>\n                    <dl>\n                        <dt>\n                            Retiro:<br/>{{ pedido.retiro }}\n                        </dt> \n                        <dd>\n                            Retorno: <br/>{{ pedido.retorno }} \n                        </dd>\n                    </dl> \n                    <dl>\n                        <dt>\n                            Día de Retiro:\n                        </dt> \n                        <dd>\n                            {{ fechaFormat(pedido.fecha_retiro) }}  \n                        </dd>\n                    </dl> \n                    <dl>\n                        <dt>\n                            Día de Retorno:   \n                        </dt> \n                        <dd>\n                            {{ fechaFormat(pedido.fecha_retorno) }}  \n                        </dd>\n                    </dl>   \n                    <dl >\n                        <dt>\n                            Drop-off \n                        </dt> \n                        <dd>\n                            {{ precioFormat(pedido.dropoff) }}\n                        </dd>\n                    </dl> \n                </section>  \n        <section class=\"info-coberturas\">\n            <h6>Modelo:</h6>\n            <dl>\n                <dt>\n                    {{ pedido.carro.tipo }}\n                      <!-- {{ precioFormat(pedido.carro.precio_thrifty) }}  x{{  storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro)  }}  -->\n                </dt> \n                <dd>\n                    {{ precioFormat(pedido.carro.precio_thrifty  * storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro)) }} \n                </dd>\n            </dl>\n            <h6>Coberturas:</h6> \n            <dl v-if=\"pedido.carro.tipo != 'Sedan'\">\n                <dt> \n                    {{ pedido.cobertura.nombre }} \n                </dt> \n                <dd>\n                    {{  precioFormat(pedido.cobertura.precio_2   * storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro))}} \n                </dd> \n            </dl>\n            <dl v-else>\n                <dt> \n                    {{ pedido.cobertura.nombre }} \n                </dt> \n                <dd>\n                    {{  precioFormat(pedido.cobertura.precio   * storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro))}} \n                </dd> \n            </dl> \n            <dl >\n                <dt> \n                    Asistencia Vial(ERA)\n                </dt> \n                <dd>\n                    {{ precioFormat(pedido.era   * storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro))}} \n                </dd> \n            </dl> \n    \n            <h6>Extras:</h6> \n            <dl v-if=\"pedido.extras\" class=\"extras\">\n                <div v-for=\"extra in pedido.extras\">\n                    <dt>\n                        {{ extra.nombre }}\n                    </dt>  \n                    <dd>\n                        {{ precioFormat(extra.precio   * storePedido.diffDias(pedido.fecha_retorno, pedido.fecha_retiro)) }} \n                    </dd> \n                </div>\n            </dl> \n\n\n            <h6>Sub-Total:  </h6> \n\n            <dl>\n                <dt> \n                </dt>\n                <dd >\n                    B/.  {{ pedido.sub_total }} \n                </dd> \n            </dl>   \n\n            <div v-if=\"pedido.impuesto_aeropuerto > 0\">\n                <h6>Impuesto de Aeropuerto:  </h6> \n    \n                <dl>\n                    <dt> \n                    </dt>\n                    <dd >\n                        B/.  {{ pedido.impuesto_aeropuerto }} \n                    </dd> \n                </dl>   \n            </div>\n            \n            <h6>Impuesto:  </h6> \n\n            <dl>\n                <dt> \n                </dt>\n                <dd >\n                    B/.  {{ pedido.impuesto }} \n                </dd> \n            </dl>   \n\n    \n            <h6>Total:  </h6> \n\n            <dl>\n                <dt> \n                </dt>\n                <dd >\n                    B/.  {{ pedido.total }} \n                </dd> \n            </dl>   \n\n\n\n        </section> \n        <footer>\n \n          {{ pedido.status }} \n            <div class=\"status\" v-if=\"pedido.status === 'Pagado'\"> \n                <h4>Esta reserva ya esta paga</h4>\n            </div>\n            <div class=\"status\"  v-if=\"pedido.status === 'Cancelado'\"> \n                <h4>El Pedido ha sido cancelado</h4>\n            </div> \n\n            <section class=\"metodos\" v-if=\"pedido.status === 'Pendiente de Pago'\">   \n                    <section class=\"tarjeta\">  \n                            <p>\n                                <label>Número de la Tarjeta</label>  \n                                <input type=\"text\" placeholder=\"0000 0000 0000 000\" name=\"ccnumber\" v-model=\"storeTarjeta.tarjeta.ccnumber\" />\n                            </p>\n                            <p>\n                                <label>Fecha de Expiración</label>  \n                                <input type=\"text\" placeholder=\"01 / 26\" name=\"ccexp\"  class=\"ccexp\" v-model=\"storeTarjeta.tarjeta.ccexp\" />\n                            </p>  \n                            <p>\n                                <label>CCV</label>  \n                                <input type=\"text\" placeholder=\"123\" name=\"cvv\" class=\"cvv\" v-model=\"storeTarjeta.tarjeta.cvv\" />\n                            </p>   \n                        <button type=\"submit\" @click=\"storeTarjeta.onSubmit\">Pagar</button>\n                    </section>  \n\n                    <div id=\"paypal-button\">\n                    </div>\n            </section> \n\n            <div class=\"status\" v-if=\"pedido.status === 'Pendiente de Pago'\"> \n                <button type=\"submit\" @click=\"storeActualizar.onCancelar\">Cancelar Reserva</button>  \n            </div>\n        </footer> \n    </section>  \n</article> \n</template>\n\n<style scoped lang=\"scss\">\n\n.manage-pedido { \n    display: flex;\n    flex-direction: column; \n    padding: 10px; \n    margin: auto;\n    margin-top: 20px;\n    margin-bottom: 20px;\n    background-color:white;\n    box-shadow: 5px 5px 5px rgba(65, 65, 65, 0.308);\n    border-radius: 5px; \n    line-height: 20px;    \n    h2 {\n        margin: 20px;\n        font-size: 28px;\n        font-weight: bold;\n    }\n    h3 {\n        font-weight: bold;\n        font-size: 22px;\n        margin-bottom: 20px;\n    }\n\n    img {\n        object-fit: cover;\n        width: 100%;\n        height: 250px;\n        border-radius: 5px;\n    }\n\n    .info-pedido {\n        display: flex;\n        flex-direction: column; \n        line-height: 1.5;\n        h6 {\n            font-weight:bold;\n            background-color: #bebebe;\n        }\n        dl {\n            display: flex;\n            justify-content: space-between;\n            background-color: #f8fbff; \n        }\n        header { \n            display: flex;\n            text-align: center;\n            margin-bottom: 10px;\n            align-items: center;\n        }\n        h3 {\n            font-weight: bold;\n            font-size: 34px;  \n            width: 100%; \n        } \n        em {\n            font-size: 24px;\n            color: gray;\n            font-style: italic; \n        }\n        p {  \n            font-size: 15px; \n            padding: 3px; \n        }  \n        img {\n            object-fit:contain;\n            width: 100%;\n            height: 160px;\n            padding: 5px;\n            border-radius: 5px;\n        }\n        .extras { \n            flex-direction: column; \n            div {\n                display: flex;\n                justify-content: space-between;\n            }\n        }\n        button {\n            background-color: #000000;\n            padding: 5px 15px;\n            border-radius: 5px; \n            text-transform: uppercase;\n            font-size: 16px;\n            font-weight: 600;\n            color:#FFD115;  \n            width: 100%;\n            text-align: center;\n        }\n    }\n\n    .metodos {\n        margin-top: 10px; \n        button {\n            background-color: #050505;\n            padding: 5px 15px;\n            border-radius: 5px;     \n            text-transform: uppercase;\n            font-size: 16px;\n            font-weight: 600;\n            color: #FFD115;\n            width: 100%;\n            text-align: center;\n            margin-top: 10px; \n        }\n        .tarjeta {\n            background-color: #bebebe;\n            padding: 20px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n            p {\n                display: flex;\n                flex-direction: column;\n            }\n            .ccexp {\n                width: 60px;\n            }\n            .cvv {\n                width: 50px;\n            }\n        }\n    }\n\n}  \n// Desktop  \n@media screen and (min-width: 768px) { \n\n    .manage-pedido { \n        display: flex;\n        flex-direction: column;  \n        margin: auto; \n        max-width: 1000px;\n        h2 {\n            margin: 20px;\n            font-size: 28px;\n            font-weight: bold;\n        }\n        h3 {\n            font-weight: bold;\n            font-size: 24px;\n            margin-bottom:0px;\n        } \n        .info-pedido {\n            display: flex;\n            flex-direction: column; \n            line-height: 1.5;\n            h6 {\n                font-weight:bold;\n                background-color: #e6e6e6;\n            }\n            dl {\n                display: flex;\n                justify-content: space-between;\n                background-color: #f8fbff; \n            }\n            header { \n                display:contents; \n                margin-bottom: 0px; \n                div { \n                    justify-content: space-around;\n                }\n            }\n            h3 {\n                font-weight: bold;\n                font-size: 34px;   \n            } \n            em {\n                font-size: 24px;\n                color: gray;\n                font-style: italic; \n            }\n            p {  \n                font-size: 15px; \n                padding: 3px; \n            }  \n            img {\n                object-fit:contain;\n                width: 100%;\n                height: 260px;\n                padding: 5px;\n                border-radius: 5px;\n            }\n            .extras { \n                flex-direction: column; \n                div {\n                    display: flex;\n                    justify-content: space-between;\n                }\n            }\n            button {\n                background-color: #000000;\n                padding: 5px 15px;\n                border-radius: 5px; \n                text-transform: uppercase;\n                font-size: 16px;\n                font-weight: 600;\n                color: #FFD115;   \n                width: 100%;\n                text-align: center;\n            }\n        }\n    \n        .metodos {\n            margin-top: 40px; \n            display: flex;\n            width: 100%; \n            justify-content: space-around; \n        }\n    \n    }  \n}\n</style>\n"],"names":["moment"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEO,MAAA,kBAAA;AAAA,EAAwB;AAAA,EAC9B;AAAA,IACD,OAAA,OAAA;AAAA,MACkB,OAAA,CAAA;AAAA,MACF,SAAA;AAAA,QACC,UAAA;AAAA,QACK,OAAA;AAAA,QACH,KAAA;AAAA,MACF;AAAA,IACT;AAAA,IACJ,SAAA;AAAA,MACS,MAAA,WAAA;AAED,cAAA,UAAA,KAAA,MAAA;AAEA,cAAA,WAAA;AAAA,UAAiB,gBAAA;AAAA,UACG,cAAA,KAAA,MAAA;AAAA,UACS,aAAA,KAAA,MAAA;AAAA,UACD,YAAA,KAAA,MAAA;AAAA,UACD,QAAA;AAAA,UACf,SAAA;AAAA,UACC,OAAA;AAAA,UACD,uBAAA,KAAA,MAAA;AAAA,UAC0B,sBAAA,KAAA,MAAA;AAAA,UACD,qBAAA;AAAA,UACZ,iBAAA;AAAA,UACJ,kBAAA;AAAA,UACC,gBAAA;AAAA,UACD,QAAA;AAAA,UACT,UAAA,KAAA,MAAA;AAAA,UACa,YAAA,KAAA,QAAA;AAAA,UACI,SAAA,KAAA,QAAA;AAAA,UACH,OAAA,KAAA,QAAA;AAAA,QACF;AAGxB,cAAA,OAAA,gBAAA;AAAA,UAA8B,QAAA;AAAA;AAAA;AAAA;AAAA,UAClB,QAAA;AAAA,UAIA,MAAA;AAAA,QACF,CAAA,EAAA,KAAA,SAAA,UAAA;AAEN,gBAAA,SAAA;AAEA,cAAA,YAAA;AACA,cAAA,iBAAA;AACA,cAAA,6BAAA;AACA,cAAA,qBAAA;AAEA,cAAA,UAAA,SAAA,cAAA,GAAA;AACI,kBAAA,EAAA,eAAA;AAEA,oBAAA,IAAA,yBAAA,OAAA;AACA,gBAAA,SAAA,EAAA,QAAA;AACA,uBAAA;AAAA,cAAmB,YAAA;AAAA,cACH,IAAA;AAAA,cACR,MAAA;AAAA,YACE,CAAA;AAEV,mBAAA,KAAA,UAAA;AAAA,UAAsB,WAAA,UAAA,SAAA,0BAAA,GAAA;AAItB,oBAAA,IAAA,uBAAA;AACA,mBAAA,KAAA,SAAA;AAAA,UAAqB,WAAA,UAAA,SAAA,kBAAA,GAAA;AAErB,oBAAA,IAAA,qBAAA;AACA,mBAAA,KAAA,SAAA;AAAA,UAAqB;AAAA,QACvB,CAAA;AAAA,MACL;AAAA,IACL;AAAA,EACJ;AACH;;;;;;;ACnED,mBAAA;AACA,UAAA,cAAA,eAAA;AACA,uBAAA;AACA,UAAA,eAAA,gBAAA;AACA,UAAA,EAAA,aAAA,aAAA;AAIA,aAAA,MAAA;AACA,aAAA,YAAA;AAAA,IACA,CAAA;AAEA,UAAA,QAAA,SAAA;AAMA,QAAA,UAAA,EAAA,UAAA,MAAA,OAAA,GAAA;AACA,UAAA;MACA,YAAA;AAAA,MACA,QAAA;AAAA,QACA,QAAA;AAAA,MACA;AAAA,IACA,CAAA,CAAA;AACA,UAAA,SAAA,QAAA,CAAA;AAMA,UAAA,cAAA,SAAA,OAAA;AACA,UAAA,OAAA;AACA,eAAAA,MAAA,KAAA,EAAA,OAAA,qBAAA;AAAA,MACA;AAAA,IACA;AACA,UAAA,eAAA,SAAA,OAAA;AACA,UAAA,OAAA;AACA,eAAA,MAAA,eAAA,SAAA,EAAA,OAAA,YAAA,UAAA,OAAA;AAAA,MACA;AAAA,IACA;AAIA,YAAA;AAAA,MACA,OAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}